<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>MOUI</title><link>https://mooouui.top/</link><description>Recent content on MOUI</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><lastBuildDate>Thu, 27 Mar 2025 21:41:33 +0800</lastBuildDate><atom:link href="https://mooouui.top/index.xml" rel="self" type="application/rss+xml"/><item><title>什么是BitTorrent</title><link>https://mooouui.top/p/what-is-bittorrent/</link><pubDate>Thu, 27 Mar 2025 21:30:02 +0800</pubDate><guid>https://mooouui.top/p/what-is-bittorrent/</guid><description>&lt;img src="https://mooouui.top/hero.svg" alt="Featured image of post 什么是BitTorrent" />&lt;h2 id="概述">概述
&lt;/h2>&lt;p>与传统客户端/服务器网络通信模式不同，对等方到对等方（P2P）通信模式在近年来越来越流行起来。
在 P2P 模式中，服务和资源分布化，资源不集中存储在某些设备上，而是分散存储在运行 P2P 程序的设备上，
每一个对等方都可以为其他对等方提供服务。
BitTorrent（中文全称比特流，简称 BT）是一个网络文件传输协议，是能够实现点对点文件分享的技术。
在大多数人感觉中与 P2P 成了对等的一组概念，而它也将 P2P 技术发展到了近乎完美的地步。
研究 BitTorrent 协议对我们深入把握 P2P 技术，了解 Interent 网络发展的未来走向有很大的意义。&lt;/p>
&lt;p>BitTorrent 协议是架构于 TCP/IP 协议之上的一个 P2P 文件传输协议，处于 TCP/IP 结构的应用层。
BitTorrent 协议本身也包含了很多具体的内容协议和扩展协议，并在不断扩充中。
如果有多个下载者并发的下载同一个文件，则每个下载者也同时为其它下载者上传文件，
这样，文件源可以支持大量的用户进行下载，而只带来适当的负载的增长。&lt;/p>
&lt;p>BitTorrent 协议把提供下载的文件虚拟分成大小相等的块，块大小必须为 2k 的整数次方
（由于是虚拟分块，硬盘上并不产生各个块文件），并把每个块的索引信息和 Hash 验证码
写入 .torrent 文件（即种子文件，也简称为“种子”）中，作为被下载文件的“索引”。
下载者要下载文件内容，需要先得到相应的 .torrent 文件，然后使用 BT 客户端软件进行下载。&lt;/p>
&lt;p>下载时，BT 客户端首先解析 .torrent 文件得到 Tracker 地址，然后连接 Tracker 服务器。
Tracker 服务器回应下载者的请求，提供下载者其他下载者（包括发布者）的 IP。
或者，BT 客户端也可解析 .torrent 文件得到 nodes 路由表，然后连接路由表中的有效节点，
由网络节点提供下载者其他下载者的 IP。&lt;/p>
&lt;p>下载者再连接其他下载者，根据 .torrent 文件，两者分别对方告知自己已经有的块，
然后交换对方没有的数据。此时不需要其他服务器参或者其他网络节点的参与，
分散了单个线路上的数据流量，因此减轻了服务器负担。
下载者每得到一个块，需要算出下载块的 Hash 验证码与 .torrent 文件中的对比，
如果一样则说明块正确，不一样则需要重新下载这个块。&lt;/p>
&lt;p>因此，下载的人越多，提供的带宽也越多，种子也会越来越多，下载速度就越快。&lt;/p>
&lt;p>从 BT 客户端角度考虑，下载原理分为以下几步：&lt;/p>
&lt;p>一．根据 BitTorrent 协议，文件发布者会根据要发布的文件生成提供一个 .torrent 文件。
客户端可从 Web 服务器上下载种子文件，并从中得到 Tracker 服务器 URL 和 DHT 网络 nodes 等信息。&lt;/p>
&lt;p>二．根据 Tracker URL 与 Tracker 服务器建立连接，并从服务器上得到 Peers 信息。
或者根据 nodes 与 DHT 网络中节点通信，并从节点上得到 Peers 信息。&lt;/p>
&lt;p>三．根据 Peers 信息与一个 Peer 建立连接，依据 Peer wire 协议完成握手，
并从 Peer 端下载数据文件。同时监听 Peer 的连接，并给 Peer 上传数据文件。&lt;/p>
&lt;p>依据得到 Peers 信息的途径的不同，可分为使用 Tracker 服务器和使用 Trackerless DHT 网络两种方式。&lt;/p>
&lt;p>基于 HTTP 的 Tracker 协议，
基于 UDP 的 Trackerless 协议，
基于 TCP 的 Peer wire 协议。&lt;/p>
&lt;h2 id="bt-种子的原理是什么">BT 种子的原理是什么？
&lt;/h2>&lt;ol>
&lt;li>
&lt;p>torrent 文件的原理：如果您这个问题是指 torrent 文件本身，那么，当您对一个文件（或者文件夹）制作成.torrent 文件，实际上生成的.torrent 文件里面主要包括了这些信息:&lt;/p>
&lt;ul>
&lt;li>这个文件（文件夹）中数据的 SHA1 值，比如一个 1G 的文件，如果按 1M 每块进行分块，则会被分为了 1000 块，torrent 中就会有这 1000 个数据块的指纹值（SHA1 的 hash 值），这个占据了 torrent 文件的绝大部分空间。这些值的目的是为了下载的过程中进行数据校验，确保数据收到的和当时源头制作 torrent 时的源文件 100%一致，防止恶意数据攻击。&lt;/li>
&lt;li>一般制作 torrent 文件时，还会要指定一个或者多个 Tracker 的地址，比如http://www.a.com:8080/announce这种地址。torrent里面一般也会存储了这个信息，这个其实也尤为重要。相当于记录了一个问询服务器的地址，这个问询服务器的作用，后面我再解释。&lt;/li>
&lt;li>文件或者文件夹内每个文件的名字，方便下载文件时，磁盘上直接命名好跟原始数据一样的目录结构、文件名。&lt;/li>
&lt;li>其它一些辅助和可扩展的信息，比如可以配置一个 P2SP 的 http 地址辅助下载，比如制作软件的名字、备注……。&lt;/li>
&lt;li>上面信息生成后，torrent 会把 A）里面的这些信息，以及 torrent 里面的文件名等关键信息，再进行一次 Hash，生成一个新的 SHA1 值，作为 torrent 的 HASH 值，也就是我们经常看到的下载软件里面对这个种子命名的一个唯一的 hash 值，也有的在 magnet 这种磁力链接中可以看到这个值，这就是 torrent 的唯一标记。以上就是.torrent 文件的内容，可以用记事本打开，但可能看到乱码。这个文件的编码遵循了 bencode 编码规则。但实际内容就主要是上面这些。所以，torrent 可以理解为对原始数据的一些记录。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>如果您的问题是指，BT 是如何通过.torrent 开始进行下载的，那么这个的原理大概是这样的：&lt;/p>
&lt;ul>
&lt;li>下载软件拿到.torrent 文件后，先进行打开，读取里面的这些信息，载入内存。&lt;/li>
&lt;li>torrent 中有 Tracker 的地址，下载软件拿到后，会去跟 Tracker 进行通讯，告诉 Tracker：我要下载这个文件（通过 hash 值作为标记）； Tracker 收到请求后，会记录这个客户端的公网 IP（记录这厮在下载这个文件），同时呢，会返回给他：我这边还知道哪些人也在下载这个文件，一般是会返回 200 个 IP（如果不够，当然就有多少返回多少）。
当然了，如果下载过程中，协议要求你必须 5 分钟跟 tracker 通讯一次，如果太久不通讯，tracker 就认为你下线了，会把你从节点列表中删除的。&lt;/li>
&lt;li>客户端拿到了一堆 IP 后，就开始挨个去尝试连接，连上后就开始互相通讯了。比如告诉对方，我有哪些分块，问问对方有哪些，然后把我有的给对方；让对方把他有的某一块给我，这样就你来我往开始了下载。当然，如果很悲催的情况下，此时没别人在线，那就只能没速度了，就只能不停的找啊找啊找朋友，直到找到一个好朋友。&lt;/li>
&lt;li>当然，如果 torrent 中有一个 P2SP 的 Http 地址辅助下载，那么也可以同时从这个 Http 服务器要数据，也会把这个服务器当成一个普通的节点，每次要 1 块数据，通过 Http 协议里面的 Range 标记，指定只要一部分数据过来辅助下载。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;p>整个 BT 的基本原理和过程就是这样，当然，这只是 BT 的基本原理，要做好一个完善的 BT 还是有很多路要走的。比如：&lt;/p>
&lt;ol>
&lt;li>如果 Tracker 服务器出问题了，连不上这个问询的服务器，就拿不到周围的邻居节点，怎么办？&amp;mdash;NB 的 BT 发明者提出了 DHT 的概念，就算 Tracker 连不上了，也可以通过分布式哈希表 DHT 技术，通过 DHT 网络慢慢的寻找志同道合的邻居节点，只是没有 Tracker 那么直接那么快速，但慢一些总还是有机会找到邻居的。&lt;/li>
&lt;li>网络是复杂的，特别是我们聪明的各个运营商，为了不让自己的用户消耗太多带宽，很多地区的运营商对 P2P 是有封锁的，比如我知道的包括某城宽带等。他们的做法早期是分析协议里面的握手消息，BT 的握手消息是明文的 Bittorrent Protocol，粗暴的运营商看到刚建立完连接就发这个明文会立即断开连接；文明点的运营商看到后不断开连接，但会限速到 20K 让你慢慢下载。当然，BT 后来也发明了加密协议，运营商也升级了封锁的设备，也开始模拟自己是一个客户端，尝试分析加密后的协议，精彩纷呈。所以，要做一个稳定的靠谱的 P2P 系统还是有不少坑要趟的。&lt;/li>
&lt;li>还有很多很多，比如 BT 对磁盘的调度、缓存的机制、文件分块的调度算法、服务器对几百万几千万用户量时的性能提升等等。&lt;/li>
&lt;/ol>
&lt;h2 id="bt-与-magnet-的下载方式及原理">BT 与 Magnet 的下载方式及原理
&lt;/h2>&lt;p>用户通过 BT 下载文件的基本过程：&lt;/p>
&lt;p>一、找到.torrent 文件&lt;/p>
&lt;p>二、使用 BT 下载客户端软件打开这个文件&lt;/p>
&lt;p>三、对于用户来讲，只要花时间去等就可以了&lt;/p>
&lt;p>而对于客户端软件来讲，它会根据.torrent 文件中的网址自动连接 Tracker 服务器，从它那里接收到其他正在下载该文件的人的网址名单。下一步，软件就一一与名单上的网址取得联系，从它们那里获取文件的片段，直到整个下载完成。从整个过程不难看出，BT Tracker 服务器是一个中央节点，任何客户端都可以在其上找到“同伴”——只要其他人也在下载或分享同一个文件。&lt;/p>
&lt;pre>&lt;code> 因此，BT并非一个去中心化的应用，必须依靠中央节点（BT Tracker服务器）才能正常工作。
&lt;/code>&lt;/pre>
&lt;p>Magnet 下载文件原理：&lt;/p>
&lt;pre>&lt;code> Magnet不需要Tracker服务器，也不需要.torrent文件，仅需要一串字符就可以进行文件下载。
DHT：2002年，纽约大学的两个教授Petar Maymounkov和David Mazières发表了一篇论文，提出了一种真正去中心化的“点对点”下载模型，他们将其称为Kademlia方法。2005年，BT软件开始引入这种技术，在BT中被称为DHT协议（Distributed Hash Table，分布式哈希表）。
&lt;/code>&lt;/pre>
&lt;p>DHT 是一种分布式存储方法。DHT 的作用是找到那些与本机正在下载（上传）相同文件的对端主机（Peer），当然，实现这一过程并不依赖 Tracker 服务器。在 DHT 网络中的每个客户端负责一个小范围的路由，并负责存储一小部分数据，从而实现整个 DHT 网络的寻址和存储。这种信息获取方式保证了整个网络没有单个的中心，即使一个节点下线，依然可以通过其他节点来获取文件，因此也就不需要 Tracker 服务器来告诉你，其他节点在什么地方。&lt;/p>
&lt;p>PEX：是 Peer Exchange 的简写，我们可以将其理解为“节点信息交换”。虽然 DHT 解决了去中心化的问题，但要在没有“中心协调员”（Tracker）的情况下实现高效寻址，就要借助 PEX。PEX 所提供的功能有点类似于以前的 Tracker 服务器，但工作方式却非常不同，我们可以打个比方来说明。&lt;/p>
&lt;p>小赵在 A 班，她不认识 B 班的小何，也不认识 C 班的小温，但小赵认识同班的小王，而小王认识 B 班的小何，也可能还认识 C 班的小温，或者小王仅认识 B 班的小何，但小何认识 C 班的小温，而小温又认识同班的所有同学，结果就是小赵可以“无限”地延伸自己的关系网，不管怎样，总有一条沟通途径可以将这些同学联系在一起，待小赵“认识”了小温后，他们就可以直接沟通了，在 P2P 世界里，就是进行上传与下载。&lt;/p>
&lt;pre>&lt;code> Magnet links：有网友将其称为磁链。DHT+PEX解决了BT“寻址”的问题，但是如何告诉BT客户端找（寻）什么又是另外一个问题。在.torrent文件中包含的内容就是用户真正要下载的文件的特征信息，或称为“电子指纹”，BT客户端知道了要找什么，也知道如何去找，于是P2P方式的下载、上传就实现了。以前BT客户端通过.torrent文件得知“要找什么”，现在，文件的“电子指纹”不再存放于.torrent中，而被放在了Magnet links中
&lt;/code>&lt;/pre>
&lt;p>例如：&lt;/p>
&lt;p>magnet:?xt=urn:btih:36684b463ca2aa2f9347b18e9f6b1a9090bdb073&amp;amp;dn=Microsoft+iSCSI+Initiator&lt;/p>
&lt;p>分解一下这个地址：&lt;/p>
&lt;p>magnet：协议名。&lt;/p>
&lt;p>xt：exact topic 的缩写，表示资源定位点。BTIH（BitTorrent Info Hash）表示哈希方法名，这里还可以使用 SHA1 和 MD5。这个值是文件的标识符，是不可缺少的。&lt;/p>
&lt;p>dn：display name 的缩写，表示向用户显示的文件名。这是一个可选项。&lt;/p>
&lt;p>tr：tracker 的缩写，表示 tracker 服务器的地址。这是一个可选项，本例中并未出现。&lt;/p>
&lt;p>精简一下上例，仅需要 magnet:?xt=urn:btih:36684b463ca2aa2f9347b18e9f6b1a9090bdb073 就够用了，如果附加 dn（display name），在使用上会更加方便一些。&lt;/p>
&lt;p>Magnet Link 的好处就不多说了，至少包括两点：网络的可靠性得到了极大的增强；不存在“被拔线”的风险。由于不存在所谓的中央节点，审查将变得更加困难，“单点失效”的问题也就不存在了。此外，Magnet URI 只是一个字符串，非常容易传播，根本无法禁止。因此，Magnet URI 取代 Tracker 模式将是大势所趋，迟早会成为主流 BT 下载方式。&lt;/p>
&lt;p>细心的网友可能看出了 DHT+PEX+Magnet Link 模式中的一个问题——BT 客户端的“第一步是如何迈出的”，套用在介绍 PEX 时使用的例子，那就是小赵是怎么“加入”A 班的呢？这确实是个问题。解决这个问题依然需要一台服务器（bootstrap node），不过这台服务器所起的作用与 Tracker 不同，它仅负责接纳小赵进入 A 班，当小赵与 A 班中的同学“搭上了话”，之后这台服务器就没有什么用处了。bootstrap node 可以是不同 BT 客户端厂商独立运营的，也可以是几家联合共用，总之，它是分散的，只要在客户端软件中内置一张表单，那客户端就将有非常多的入口可供选择。&lt;/p></description></item><item><title>关于</title><link>https://mooouui.top/about/</link><pubDate>Thu, 27 Mar 2025 00:00:00 +0000</pubDate><guid>https://mooouui.top/about/</guid><description>&lt;p>WIP&lt;/p></description></item><item><title>归档</title><link>https://mooouui.top/archives/</link><pubDate>Thu, 27 Mar 2025 00:00:00 +0000</pubDate><guid>https://mooouui.top/archives/</guid><description/></item><item><title>Emby + Aria2 + Infuse</title><link>https://mooouui.top/p/emby-aria2-infuse/</link><pubDate>Sat, 27 Apr 2024 21:41:33 +0800</pubDate><guid>https://mooouui.top/p/emby-aria2-infuse/</guid><description>&lt;h2 id="emby">emby
&lt;/h2>&lt;p>&lt;a class="link" href="https://hub.docker.com/r/emby/embyserver" target="_blank" rel="noopener"
>docker&lt;/a>&lt;/p>
&lt;h3 id="不同内核-仓库不同">不同内核 仓库不同
&lt;/h3>&lt;p>Emby supports the following architectures, each with its own dedicated repository.&lt;/p>
&lt;ul>
&lt;li>amd64: emby/embyserver&lt;/li>
&lt;li>arm32v7: emby/embyserver_arm32v7&lt;/li>
&lt;li>arm64v8: emby/embyserver_arm64v8&lt;/li>
&lt;/ul>
&lt;h3 id="docker-compose">docker compose
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yml" data-lang="yml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">version&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;2.3&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">services&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">emby&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">emby/embyserver&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">container_name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">embyserver&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c"># runtime: nvidia # Expose NVIDIA GPUs&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">network_mode&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">host&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># Enable DLNA and Wake-on-Lan&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">environment&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">UID=1000 # The UID to run emby as (default&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">2&lt;/span>&lt;span class="l">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">GID=100&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># The GID to run emby as (default 2)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">GIDLIST=100 # A comma-separated list of additional GIDs to run emby as (default&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">2&lt;/span>&lt;span class="l">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">volumes&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">/path/to/programdata:/config&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># Configuration directory&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">/path/to/tvshows:/mnt/share1&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># Media directory&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">/path/to/movies:/mnt/share2&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># Media directory&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="m">8096&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="m">8096&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># HTTP port&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="m">8920&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="m">8920&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># HTTPS port&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">devices&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">/dev/dri:/dev/dri&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># VAAPI/NVDEC/NVENC render nodes&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c"># - /dev/vchiq:/dev/vchiq # MMAL/OMX on Raspberry Pi&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">restart&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">on&lt;/span>-&lt;span class="l">failure&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="aria2pro">aria2pro
&lt;/h2>&lt;p>&lt;a class="link" href="https://hub.docker.com/r/p3terx/aria2-pro" target="_blank" rel="noopener"
>docker&lt;/a>&lt;/p>
&lt;h3 id="bridge-网络模式">bridge 网络模式
&lt;/h3>&lt;p>ma­cOS 和 Win­dows 必须要使用 bridge 网络模式。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;span class="lnt">29
&lt;/span>&lt;span class="lnt">30
&lt;/span>&lt;span class="lnt">31
&lt;/span>&lt;span class="lnt">32
&lt;/span>&lt;span class="lnt">33
&lt;/span>&lt;span class="lnt">34
&lt;/span>&lt;span class="lnt">35
&lt;/span>&lt;span class="lnt">36
&lt;/span>&lt;span class="lnt">37
&lt;/span>&lt;span class="lnt">38
&lt;/span>&lt;span class="lnt">39
&lt;/span>&lt;span class="lnt">40
&lt;/span>&lt;span class="lnt">41
&lt;/span>&lt;span class="lnt">42
&lt;/span>&lt;span class="lnt">43
&lt;/span>&lt;span class="lnt">44
&lt;/span>&lt;span class="lnt">45
&lt;/span>&lt;span class="lnt">46
&lt;/span>&lt;span class="lnt">47
&lt;/span>&lt;span class="lnt">48
&lt;/span>&lt;span class="lnt">49
&lt;/span>&lt;span class="lnt">50
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-yml" data-lang="yml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">version&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;3.8&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">services&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">Aria2-Pro&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">container_name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">aria2-pro&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">p3terx/aria2-pro&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">environment&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">PUID=65534&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">PGID=65534&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">UMASK_SET=022&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">RPC_SECRET=P3TERX&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">RPC_PORT=6800&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">LISTEN_PORT=6888&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">DISK_CACHE=64M&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">IPV6_MODE=false&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">UPDATE_TRACKERS=true&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">CUSTOM_TRACKER_URL=&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">TZ=Asia/Shanghai&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">volumes&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">${PWD}/aria2-config:/config&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">${PWD}/aria2-downloads:/downloads&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c"># If you use host network mode, then no port mapping is required.&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c"># This is the easiest way to use IPv6 networks.&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c">#network_mode: host&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">network_mode&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">bridge&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="m">6800&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="m">6800&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="m">6888&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="m">6888&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="m">6888&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="m">6888&lt;/span>&lt;span class="l">/udp&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">restart&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">unless-stopped&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c"># Since Aria2 will continue to generate logs, limit the log size to 1M to prevent your hard disk from running out of space.&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">logging&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">driver&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">json-file&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">options&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">max-size&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">1m&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c"># AriaNg is just a static web page, usually you only need to deploy on a single host.&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">AriaNg&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">container_name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ariang&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">p3terx/ariang&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c">#command: --port 6880 --ipv6&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c">#network_mode: host&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">network_mode&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">bridge&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">ports&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="m">6880&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="m">6880&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">restart&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">unless-stopped&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">logging&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">driver&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">json-file&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">options&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">max-size&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">1m&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="infuse">infuse
&lt;/h2>&lt;p>方便集成 emby plex 等，用于多端的视频推流，解码在线观看&lt;/p></description></item><item><title>如何使用vite脚手架构建一个vue3项目</title><link>https://mooouui.top/p/how-to-build-a-vue3-project-with-vite-scaffold/</link><pubDate>Sat, 27 Apr 2024 15:51:02 +0800</pubDate><guid>https://mooouui.top/p/how-to-build-a-vue3-project-with-vite-scaffold/</guid><description>&lt;img src="https://mooouui.top/p/how-to-build-a-vue3-project-with-vite-scaffold/hero.svg" alt="Featured image of post 如何使用vite脚手架构建一个vue3项目" />&lt;h2 id="用-vite-脚手架初始化项目">用 vite 脚手架初始化项目
&lt;/h2>&lt;p>运行命令 -&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">yarn create vite
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>result -
&lt;img src="https://mooouui.top/p/how-to-build-a-vue3-project-with-vite-scaffold/create-vite.png"
width="816"
height="668"
srcset="https://mooouui.top/p/how-to-build-a-vue3-project-with-vite-scaffold/create-vite_hu_ee832475963a945c.png 480w, https://mooouui.top/p/how-to-build-a-vue3-project-with-vite-scaffold/create-vite_hu_60be092429d275ba.png 1024w"
loading="lazy"
alt="result"
class="gallery-image"
data-flex-grow="122"
data-flex-basis="293px"
>&lt;/p>
&lt;p>生成的树形目录 -
&lt;img src="https://mooouui.top/p/how-to-build-a-vue3-project-with-vite-scaffold/tree-menu.png"
width="816"
height="600"
srcset="https://mooouui.top/p/how-to-build-a-vue3-project-with-vite-scaffold/tree-menu_hu_68dd906cedb4c534.png 480w, https://mooouui.top/p/how-to-build-a-vue3-project-with-vite-scaffold/tree-menu_hu_4223cf71dcb25579.png 1024w"
loading="lazy"
alt="tree menu"
class="gallery-image"
data-flex-grow="136"
data-flex-basis="326px"
>&lt;/p>
&lt;h2 id="配置-eslint">配置 eslint
&lt;/h2>&lt;h3 id="安装-eslint">安装 eslint
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">yarn add -D eslint
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="eslint-init">eslint init
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl"> yarn eslint --init
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>result -
&lt;img src="https://mooouui.top/p/how-to-build-a-vue3-project-with-vite-scaffold/eslint-init.png"
width="1592"
height="578"
srcset="https://mooouui.top/p/how-to-build-a-vue3-project-with-vite-scaffold/eslint-init_hu_2d95ef5dbe2c066.png 480w, https://mooouui.top/p/how-to-build-a-vue3-project-with-vite-scaffold/eslint-init_hu_d5ea5901365cfd.png 1024w"
loading="lazy"
alt="init eslint"
class="gallery-image"
data-flex-grow="275"
data-flex-basis="661px"
>&lt;/p>
&lt;p>会在目录下生成&lt;code>.eslintrc.*&lt;/code>文件，但会有一个报错，需要在 env 下加&lt;code>&amp;quot;node&amp;quot;: true&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// ❌ &amp;#39;module&amp;#39; is not defined.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nx">module&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">exports&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">env&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">browser&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="kc">true&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">es2021&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="kc">true&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// add here resolve *&amp;#39;module&amp;#39; is not defined* bug
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">node&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="kc">true&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>eslint 对 env node 的解释：node - Node.js 的全局变量和 Node.js 的范围。
它会暴露出 nodejs 的全局变量（module 是其中之一）&lt;/p>
&lt;h3 id="在-packagejson-配置-script">在 package.json 配置 script
&lt;/h3>&lt;p>在 script 下添加&lt;code>&amp;quot;lint&amp;quot;: &amp;quot;eslint . --ext .vue,.js,.ts,.jsx,.tsx --fix&amp;quot;&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 运行&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yarn lint
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>会提示有报错信息&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">moui@bogon vite-project % yarn lint
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yarn run v1.22.19
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$ eslint . --ext .vue,.js,.ts,.jsx,.tsx --fix
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/Users/moui/CodeSpace/vite-project/src/App.vue
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 1:8 error Parsing error: &lt;span class="s1">&amp;#39;&amp;gt;&amp;#39;&lt;/span> expected
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/Users/moui/CodeSpace/vite-project/src/components/HelloWorld.vue
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 1:8 error Parsing error: &lt;span class="s1">&amp;#39;&amp;gt;&amp;#39;&lt;/span> expected
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">✖ &lt;span class="m">2&lt;/span> problems &lt;span class="o">(&lt;/span>&lt;span class="m">2&lt;/span> errors, &lt;span class="m">0&lt;/span> warnings&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">error Command failed with &lt;span class="nb">exit&lt;/span> code 1.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>原因：eslint 配置的 &lt;code>parser: &amp;quot;@typescript-eslint/parser&amp;quot;&lt;/code> 是不会处理 vue 的 SFC 文件的 lint 的，对于.vue 的文件需要借助
&lt;code>eslint-plugin-vue&lt;/code>，在&lt;code>eslint-plugin-vue&lt;/code>的官方文档文档中有说明：&lt;strong>如果您已经使用另一个解析器（例如 &amp;ldquo;parser&amp;rdquo;: &amp;ldquo;@typescript-eslint/parser&amp;rdquo; ），请将其移至 parserOptions 中，这样它就不会与此插件配置使用的 vue-eslint-parser 冲突&lt;/strong>
所以要把 eslint 的配置文件改为：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-diff" data-lang="diff">&lt;span class="line">&lt;span class="cl">&lt;span class="gd">- &amp;#34;parser&amp;#34;: &amp;#34;@typescript-eslint/parser&amp;#34;,
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="gd">&lt;/span>&lt;span class="gi">+ &amp;#34;parser&amp;#34;: &amp;#34;vue-eslint-parser&amp;#34;,
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="gi">&lt;/span> &amp;#34;parserOptions&amp;#34;: {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="gi">+ &amp;#34;parser&amp;#34;: &amp;#34;@typescript-eslint/parser&amp;#34;,
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="gi">&lt;/span> }
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="配置-prettier">配置 prettier
&lt;/h2>&lt;h3 id="安装-prettier">安装 prettier
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">yarn add -D prettier
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="创建配置文件">创建配置文件
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">touch .prettierrc.cjs
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>内容配置参考：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">module&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">exports&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// 一行的字符数，如果超过会进行换行，默认为80
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">printWidth&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">80&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// 一个tab代表几个空格数，默认为2
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">tabWidth&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// 是否使用tab进行缩进，默认为false，表示用空格进行缩减
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">useTabs&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="kc">false&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// 字符串是否使用单引号，默认为false，使用双引号
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">singleQuote&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="kc">true&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// 行位是否使用分号，默认为true
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">semi&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="kc">false&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// 是否使用尾逗号，有三个可选值&amp;#34;&amp;lt;none|es5|all&amp;gt;&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">trailingComma&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;none&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// 对象大括号直接是否有空格，默认为true，效果：{ foo: bar }
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">bracketSpacing&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="kc">true&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="解决冲突">解决冲突
&lt;/h3>&lt;p>理论上&lt;code>eslint&lt;/code>用于解决我们的代码规范，确保我们的代码质量， 而&lt;code>prettier&lt;/code>则是用于优化我们的代码格式，提供更好的可读性和美观度。
即&lt;strong>使用 Prettier 来解决代码格式问题，使用 linter 来解决代码质量问题&lt;/strong>
但实际上 Linters 通常不仅包含代码质量规则，还包含风格规则。使用 Prettier 时，大多数风格规则都是不必要的，但更糟糕的是——它们可能与 Prettier 发生冲突！
但幸运的是可以通过一些配置关闭 linters 和 prettier 的冲突&lt;/p>
&lt;ol>
&lt;li>
&lt;p>&lt;code>eslint-config-prettier&lt;/code>
关闭所有不必要或可能与 Prettier 冲突的规则。&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>eslint-plugin-prettier&lt;/code>
以 ESLint 规则运行 Prettier，并将差异报告为单独的 ESLint 问题 （基于 prettier 代码风格的 eslint 规则，即 eslint 使用 pretter 规则来格式化代码。）&lt;/p>
&lt;/li>
&lt;/ol>
&lt;p>&lt;code>eslint-plugin-prettier&lt;/code>:
This plugin works best if you disable all other ESLint rules relating to code formatting, and only enable rules that detect potential bugs. (If another active ESLint rule disagrees with prettier about how code should be formatted, it will be impossible to avoid lint errors.) You can use &lt;code>eslint-config-prettier&lt;/code> to disable all formatting-related ESLint rules.&lt;/p>
&lt;p>所以基于此，我们可以配置&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="line">&lt;span class="cl">yarn add -D eslint-config-prettier eslint-plugin-prettier
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>插件&lt;code>eslint-plugin-prettier&lt;/code>附带一个 plugin:prettier/recommended 配置，可一次性设置插件和 &lt;code>eslint-config-prettier&lt;/code>&lt;/p>
&lt;p>然后您需要添加 plugin:prettier/recommended 作为 &lt;code>.eslintrc.*&lt;/code> 中的&lt;strong>最后&lt;/strong>一个扩展：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-diff" data-lang="diff">&lt;span class="line">&lt;span class="cl">module.exports = {
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> //...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> extends: [
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#39;eslint:recommended&amp;#39;,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#39;plugin:vue/vue3-essential&amp;#39;,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;#39;plugin:@typescript-eslint/recommended&amp;#39;,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="gi">+ &amp;#39;plugin:prettier/recommended&amp;#39; // 新增，必须放在最后面
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="gi">&lt;/span> ],
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> //...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>之后我们就可以在&lt;code>.prettierrc.*&lt;/code>中设置自己的 prettier 规则了&lt;/p></description></item><item><title>链接</title><link>https://mooouui.top/links/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://mooouui.top/links/</guid><description>&lt;p>WIP&lt;/p></description></item><item><title>搜索</title><link>https://mooouui.top/search/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://mooouui.top/search/</guid><description/></item></channel></rss>